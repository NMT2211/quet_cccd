<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CT01 ‚Äì T·ªù khai thay ƒë·ªïi th√¥ng tin c∆∞ tr√∫ (Nh·∫≠p li·ªáu + Preview + In/PDF)</title>

  <!-- N·∫øu b·∫°n c√≥ style.css ri√™ng th√¨ gi·ªØ, kh√¥ng c√≥ th√¨ x√≥a -->
  <link rel="stylesheet" href="./style.css">

  <style>
    :root{
      /* ‚úÖ LIGHT THEME */
      --bg:#ffffff;
      --card:#ffffff;
      --card2:#f7f8fb;
      --text:#0f172a;
      --muted:#475569;
      --line:#e5e7eb;

      --accent:#2563eb;
      --ok:#16a34a;
      --danger:#dc2626;
      --warn:#d97706;

      --radius:16px;

      /* A4 tokens */
      --a4w:210mm;
      --a4h:297mm;
      --pad:12mm;
      --printText:#111;
      --printLine:#000;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: var(--bg);
      color: var(--text);
    }

    .wrap{
      margin: 24px auto;
      max-width: 1700px;
      padding: 0 16px 28px;
    }

    .topbar{
      display:flex;
      gap:12px;
      align-items:flex-start;
      justify-content:space-between;
      margin: 14px 0;
      flex-wrap: wrap;
    }
    .title{ display:flex; flex-direction:column; gap:6px; }
    .title h1{ margin:0; font-size:20px; letter-spacing:.2px; }
    .title p{ margin:0; color:var(--muted); font-size:13px; line-height:1.4; }

    .actions{
      display:flex; flex-wrap:wrap; gap:8px; justify-content:flex-end;
    }
    .btn{
      border:1px solid var(--line);
      background:#fff;
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      font-weight:700;
      font-size:13px;
      display:inline-flex;
      align-items:center;
      gap:8px;
      user-select:none;
      transition:.15s ease;
    }
    .btn:hover{ transform: translateY(-1px); background: #f8fafc; }
    .btn.primary{ background:rgba(37,99,235,.10); border-color:rgba(37,99,235,.35); }
    .btn.primary:hover{ background:rgba(37,99,235,.16); }
    .btn.ok{ background:rgba(22,163,74,.10); border-color:rgba(22,163,74,.30); }
    .btn.warn{ background:rgba(217,119,6,.10); border-color:rgba(217,119,6,.30); }
    .btn.danger{ background:rgba(220,38,38,.08); border-color:rgba(220,38,38,.25); }

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      align-items:start;
    }
    @media (max-width: 980px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      background: var(--card);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: 0 14px 38px rgba(15,23,42,.08);
      overflow:hidden;
    }
    .card h2{
      margin:0;
      padding:12px 14px;
      font-size:14px;
      letter-spacing:.2px;
      border-bottom:1px solid var(--line);
      background: var(--card2);
    }
    .card .body{ padding:14px; }

    .row{ display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
    .row3{ display:grid; grid-template-columns: 1fr 1fr 1fr; gap:10px; }
    .row1{ display:grid; grid-template-columns: 1fr; gap:10px; }
    @media (max-width: 680px){
      .row, .row3{ grid-template-columns: 1fr; }
    }

    label{
      display:block;
      font-size:12px;
      color:var(--muted);
      margin:0 0 6px;
      font-weight:700;
    }
    input, select, textarea{
      width:100%;
      padding:10px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      background:#fff;
      color:var(--text);
      outline:none;
      font-size:14px;
    }
    textarea{ min-height: 92px; resize:vertical; }
    input:focus, select:focus, textarea:focus{
      border-color: rgba(37,99,235,.55);
      box-shadow: 0 0 0 3px rgba(37,99,235,.15);
    }
    .hint{
      margin-top:6px;
      font-size:12px;
      color:var(--muted);
      line-height:1.4;
    }

    .table{
      width:100%;
      border-collapse: collapse;
      margin-top:8px;
      overflow:hidden;
      border-radius:12px;
      border:1px solid var(--line);
    }
    .table th, .table td{
      border-bottom:1px solid var(--line);
      padding:8px;
      font-size:13px;
      vertical-align:top;
    }
    .table th{
      background: var(--card2);
      text-align:left;
      font-weight:800;
    }
    .table td input{
      padding:8px;
      border-radius:10px;
      font-size:13px;
      background:#fff;
    }
    .table tr:last-child td{ border-bottom:none; }

    .subactions{ display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }

    /* Preview A4 */
    .previewShell{ padding:14px; background: #fafafa; }
    .a4{
      width: var(--a4w);
      min-height: var(--a4h);
      margin: 0 auto;
      background:#fff;
      color: var(--printText);
      border-radius: 8px;
      box-shadow: 0 20px 60px rgba(0,0,0,.12);
      padding: var(--pad);
      font-family: "Times New Roman", Times, serif;
      border: 1px solid #e5e7eb;
    }

    .center{ text-align:center; }
    .small{ font-size:10.5pt; }
    .muted{ color:#333; }

    /* dotted line placeholder; hide when filled */
    .line{
      display:inline-block;
      border-bottom: 1px dotted #111;
      min-width: 90mm;
      transform: translateY(-2px);
    }
    .line.filled{ border-bottom: none !important; }

    .fill{ font-weight:700; }
    .rowPrint{
      display:flex;
      gap:10mm;
      align-items:flex-end;
      margin-top:4px;
      font-size:13pt;
      line-height:1.35;
      flex-wrap:wrap;
    }
    .rowPrint .col{ flex: 1 1 auto; min-width: 70mm; }
    .rowPrint .col.sm{ min-width: 50mm; }
    .rowPrint .col.xs{ min-width: 35mm; }
    .nowrap{ white-space:nowrap; }

    .boxes{
      display:inline-flex;
      margin-left:2mm;
      transform: translateY(2px);

    }
    .box{
      width:7mm;
      height:8mm;
      border:1px solid #111;
      border-left:0 ;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:13pt;
      font-weight:700;
    }
    .box1{
        border:1px solid #111;
    }

    .cccd{
        height: auto;
        align-items: center;
    }

    .hr{
      margin:6mm 0 4mm;
      border-top:1px solid #111;
      opacity:.10;
    }

    .printTable{
      width:100%;
      border-collapse:collapse;
      margin-top:3mm;
      font-size:11pt;
    }
    .printTable th, .printTable td{
      border:1px solid #111;
      padding:3mm 2mm;
      vertical-align:top;
    }
    .printTable th{ text-align:center; font-weight:700; }

    .sigRow{

      display:grid;
      grid-template-columns: 1fr 1fr 1fr 1fr;
      gap:5mm;
      margin-top:6mm;
      font-size:10.5pt;
      margin-left: -15px;
      
    }
    .sig{
      text-align:center;
      min-height: 35mm;
      width: 170px;
    }
    .sig .cap{
      font-weight:700;
      text-transform:uppercase;
      font-size:10pt;
      margin-bottom:2mm;
      
    }
    .sig .note{ font-size:9.5pt; }
    .sig .fillName{ margin-top:18mm; font-weight:700; }

    /* Print only */
    @media print{
      body{ background:#fff; }
      #nav-host{ display:none !important; }
      .wrap, .topbar, .grid{ display:none !important; }
      .printOnly{ display:block !important; padding:0 !important; margin:0 !important; }
      .a4{
        box-shadow:none !important;
        border-radius:0 !important;
        width:210mm !important;
        min-height:297mm !important;
        padding:12mm !important;
        border:none !important;
      }
    }
    .printOnly{ display:none; }

    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size:12px;
      color:var(--muted);
      background: var(--card2);
      border:1px solid var(--line);
      padding:8px 10px;
      border-radius:999px;
      margin-top:10px;
      font-weight:700;
    }
    .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      background:#fff;
      border:1px solid var(--line);
      padding:2px 6px;
      border-radius:8px;
      color:#0f172a;
      font-size:12px;
      font-weight:800;
    }
    /* ===== Print line system (stable) ===== */
.printLine{
  display:flex;
  gap:2mm;
  margin-top:5mm;
  font-size:13pt;
  line-height:1.35;
}

.printLine .lbl{ white-space:nowrap; }

.printLine .line{
  flex:1;
  min-width:0 !important;   /* ‚úÖ cho ph√©p co theo kh·ªï A4 */
  display:block;            /* ‚úÖ ƒë·ªÉ flex ƒÉn v√†o line */
  transform:none;
  vertical-align:baseline;
}

.printGrid2{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:10mm;
  align-items:end;
  margin-top:5mm;
}

/* boxes c≈©ng b·ªè transform cho kh·ªèi l·ªách baseline */

/* ‚úÖ m·ª•c 10 d√†i: cho ph√©p xu·ªëng d√≤ng ƒë·∫πp */
.printLineLong{
  align-items:flex-start;
}

.printLineLong .val{
  flex:1;
  min-width:0;            /* c·ª±c quan tr·ªçng ƒë·ªÉ wrap trong flex */
}

/* √©p lineFill chi·∫øm full ph·∫ßn c√≤n l·∫°i ƒë·ªÉ text t·ª± xu·ªëng d√≤ng */
.printLineLong .val .line{
  width:100%;
  display:block;
  min-width:0 !important;
  border-bottom:1px dotted #111;
}

.printLineLong .val .fill{
  white-space:normal;
  word-break:break-word;
}

  </style>
</head>

<body>
  <!-- NAV (load from nav.html) -->
  <div id="nav-host"></div>

  <div class="wrap">
    <div class="topbar">
      <div class="title">
        <h1>CT01 ‚Äì Nh·∫≠p li·ªáu ‚Üí Preview ‚Üí In/L∆∞u PDF (A4)</h1>
        <p>
          C√¥ng c·ª• h·ªó tr·ª£ ƒëi·ªÅn CT01 ƒë·ªÉ in/l∆∞u. B·∫°n v·∫´n n√™n ƒë·ªëi chi·∫øu l·∫°i v·ªõi m·∫´u CT01 b·∫°n ƒëang d√πng tr√™n C·ªïng DVC/VNeID tr∆∞·ªõc khi n·ªôp.
        </p>
        <div class="badge">
          üí° G·ª£i √Ω: Nh·∫•n <span class="kbd">Ctrl</span> + <span class="kbd">P</span> ‚Üí ‚ÄúSave as PDF‚Äù ƒë·ªÉ t·∫£i file PDF
        </div>
      </div>

      <div class="actions">
        <button class="btn primary" id="btnPreview" type="button">üëÄ C·∫≠p nh·∫≠t Preview</button>
        <button class="btn ok" id="btnPrint" type="button">üñ®Ô∏è In / L∆∞u PDF</button>
        <button class="btn warn" id="btnDownloadJson" type="button">‚¨áÔ∏è T·∫£i JSON</button>
        <button class="btn" id="btnLoadJson" type="button">‚¨ÜÔ∏è N·∫°p JSON</button>
        <button class="btn danger" id="btnReset" type="button">üßπ X√≥a d·ªØ li·ªáu</button>
      </div>
    </div>

    <div class="grid">
      <!-- INPUT -->
      <div class="card">
        <h2>1) Nh·∫≠p th√¥ng tin</h2>
        <div class="body">
          <div class="row1">
            <div>
              <label>K√≠nh g·ª≠i (1)</label>
              <input id="agency" placeholder="VD: C√¥ng an ph∆∞·ªùng ..., TP. H·ªì Ch√≠ Minh" value="C√¥ng an ph∆∞·ªùng B√¨nh C∆°, TP. H·ªì Ch√≠ Minh"/>
              <div class="hint">Ghi ƒë√∫ng c∆° quan ti·∫øp nh·∫≠n h·ªì s∆° (C√¥ng an c·∫•p x√£/ph∆∞·ªùng‚Ä¶ ho·∫∑c n∆°i c√≥ th·∫©m quy·ªÅn).</div>
            </div>
          </div>

          <div class="row">
            <div>
              <label>1. H·ªç, ch·ªØ ƒë·ªám v√† t√™n khai sinh</label>
              <input id="fullName" placeholder="VD: NGUY·ªÑN VƒÇN A" />
            </div>
            <div>
              <label>3. Gi·ªõi t√≠nh</label>
              <select id="gender">
                <option value="">-- Ch·ªçn --</option>
                <option>Nam</option>
                <option>N·ªØ</option>
                <option>Kh√°c</option>
              </select>
            </div>
          </div>

          <div class="row">
            <div>
              <label>2. Ng√†y, th√°ng, nƒÉm sinh</label>
              <input id="dob" placeholder="dd/mm/yyyy" />
              <div class="hint">VD: 01/01/2000</div>
            </div>
            <div>
              <label>4. S·ªë ƒë·ªãnh danh c√° nh√¢n (12 s·ªë)</label>
              <input id="idNumber" maxlength="12" inputmode="numeric" placeholder="VD: 012345678901" />
            </div>
          </div>

          <div class="row">
            <div>
              <label>5. S·ªë ƒëi·ªán tho·∫°i li√™n h·ªá</label>
              <input id="phone" placeholder="VD: 09xxxxxxxx" />
            </div>
            <div>
              <label>6. Email</label>
              <input id="email" placeholder="VD: abc@gmail.com" />
            </div>
          </div>

          <div class="hr"></div>

          <div class="row">
            <div>
              <label>7. H·ªç, ch·ªØ ƒë·ªám v√† t√™n ch·ªß h·ªô</label>
              <input id="householdHeadName" placeholder="VD: TR·∫¶N VƒÇN B" />
            </div>
            <div>
              <label>8. M·ªëi quan h·ªá v·ªõi ch·ªß h·ªô</label>
              <input id="relationToHead" placeholder="VD: Con / V·ª£ / Ch·ªìng / Thu√™ tr·ªç..." />
            </div>
          </div>

          <div class="row">
            <div>
              <label>9. S·ªë ƒë·ªãnh danh c√° nh√¢n c·ªßa ch·ªß h·ªô (12 s·ªë)</label>
              <input id="headIdNumber" maxlength="12" inputmode="numeric" placeholder="VD: 012345678901" />
            </div>
            <div>
              <label>Tu·ª≥ ch·ªçn: Lo·∫°i y√™u c·∫ßu</label>
              <select id="requestType">
                <option value="tamtru">ƒêƒÉng k√Ω t·∫°m tr√∫</option>
                <option value="dieuchinh">ƒêi·ªÅu ch·ªânh th√¥ng tin c∆∞ tr√∫</option>
                <option value="xacnhan">X√°c nh·∫≠n th√¥ng tin c∆∞ tr√∫</option>
                <option value="khac">Kh√°c (t·ª± nh·∫≠p n·ªôi dung)</option>
              </select>
            </div>
          </div>

          <!-- Builder for temporary residence -->
          <div class="card" style="margin-top:12px; background: var(--card2); border-color: var(--line); box-shadow:none">
            <h2 style="border-bottom:1px solid var(--line); background: transparent;">2) D·ª±ng ‚ÄúN·ªôi dung ƒë·ªÅ ngh·ªã‚Äù (10) nhanh (ƒë·∫∑c bi·ªát cho ƒëƒÉng k√Ω t·∫°m tr√∫)</h2>
            <div class="body">
              <div class="row1">
                <div>
                  <label>ƒê·ªãa ch·ªâ n∆°i ƒë·ªÅ ngh·ªã ƒëƒÉng k√Ω t·∫°m tr√∫</label>
                  <input id="tempAddress" placeholder="VD: 12/3 ƒê∆∞·ªùng ABC, P. ..., Q. ..., TP. ..." />
                </div>
              </div>
              <div class="row3">
                <div>
                  <label>T·ª´ ng√†y</label>
                  <input id="fromDate" placeholder="dd/mm/yyyy" />
                </div>
                <div>
                  <label>ƒê·∫øn ng√†y (c√≥ th·ªÉ ƒë·ªÉ tr·ªëng)</label>
                  <input id="toDate" placeholder="dd/mm/yyyy" />
                </div>
                <div>
                  <label>L√Ω do / ghi ch√∫</label>
                  <input id="reason" placeholder="VD: Thu√™ tr·ªç ƒë·ªÉ l√†m vi·ªác/h·ªçc t·∫≠p..." />
                </div>
              </div>
              <div class="hint">N·∫øu b·∫°n ch·ªçn ‚ÄúKh√°c‚Äù, b·∫°n c√≥ th·ªÉ nh·∫≠p n·ªôi dung ƒë·ªÅ ngh·ªã t·ª± do ·ªü √¥ (10) b√™n d∆∞·ªõi.</div>
            </div>
          </div>

          <div class="row1" style="margin-top:12px">
            <div>
              <label>10. N·ªôi dung ƒë·ªÅ ngh·ªã (2)</label>
              <textarea id="requestContent" placeholder="N·ªôi dung s·∫Ω t·ª± g·ª£i √Ω theo lo·∫°i y√™u c·∫ßu, b·∫°n c√≥ th·ªÉ s·ª≠a l·∫°i cho ƒë√∫ng th·ª±c t·∫ø..."></textarea>
            </div>
          </div>

          <div class="hr"></div>

          <div class="row1">
            <div>
              <label>11. Nh·ªØng th√†nh vi√™n trong h·ªô gia ƒë√¨nh c√πng thay ƒë·ªïi (n·∫øu c√≥)</label>
              <table class="table" id="membersTable">
                <thead>
                  <tr>
                    <th style="width:48px">TT</th>
                    <th>H·ªç, ch·ªØ ƒë·ªám v√† t√™n</th>
                    <th style="width:140px">Ng√†y sinh</th>
                    <th style="width:90px">Gi·ªõi t√≠nh</th>
                    <th style="width:170px">S·ªë ƒë·ªãnh danh</th>
                    <th style="width:160px">Quan h·ªá v·ªõi ch·ªß h·ªô</th>
                    <th style="width:56px"></th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>

              <div class="subactions">
                <button class="btn" id="btnAddMember" type="button">‚ûï Th√™m th√†nh vi√™n</button>
              </div>
              <div class="hint">N·∫øu kh√¥ng c√≥ ai c√πng thay ƒë·ªïi, c·ª© ƒë·ªÉ tr·ªëng b·∫£ng n√†y.</div>
            </div>
          </div>

          <div class="hr"></div>

          <div class="row">
            <div>
              <label>Ng√†y l·∫≠p t·ªù khai</label>
              <input id="declareDate" placeholder="dd/mm/yyyy" />
            </div>
            <div>
              <label>ƒê·ªãa danh (vd: TP. H·ªì Ch√≠ Minh)</label>
              <input id="place" placeholder="VD: TP. H·ªì Ch√≠ Minh" />
            </div>
          </div>

          <div class="row3">
            <div>
              <label>Ch·ªß h·ªô (t√™n ƒë·ªÉ hi·ªán ·ªü ph·∫ßn ch·ªØ k√Ω)</label>
              <input id="sigHead" placeholder="(K√Ω, ghi r√µ h·ªç t√™n) ‚Äì n·∫øu c√≥" />
            </div>
            <div>
              <label>Ch·ªß s·ªü h·ªØu ch·ªó ·ªü h·ª£p ph√°p (t√™n)</label>
              <input id="sigOwner" placeholder="(K√Ω, ghi r√µ h·ªç t√™n) ‚Äì n·∫øu c√≥" />
            </div>
            <div>
              <label>Cha/M·∫π/Ng∆∞·ªùi gi√°m h·ªô (t√™n)</label>
              <input id="sigGuardian" placeholder="(K√Ω, ghi r√µ h·ªç t√™n) ‚Äì n·∫øu c√≥" />
            </div>
          </div>

          <div class="row">
            <div>
              <label>Ng∆∞·ªùi k√™ khai (t√™n)</label>
              <input id="sigDeclarer" placeholder="(K√Ω, ghi r√µ h·ªç t√™n)" />
            </div>
            <div>
              <label>Ghi ch√∫ th√™m (tu·ª≥ ch·ªçn)</label>
              <input id="extraNote" placeholder="VD: N·ªôp online qua DVC/VNeID..." />
            </div>
          </div>
        </div>
      </div>

      <!-- PREVIEW -->
      <div class="card">
        <h2>2) Preview CT01 (A4)</h2>
        <div class="previewShell">
          <div class="a4" id="a4"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- PRINT VERSION -->
  <div class="printOnly">
    <div class="a4" id="a4Print"></div>
  </div>

  <input type="file" id="jsonFile" accept="application/json" style="display:none" />

  <script>
    // ===== NAV LOADER (optional) =====
    async function mountNav(){
      const host = document.getElementById("nav-host");
      if(!host) return;
      try{
        const res = await fetch("./nav.html", { cache:"no-store" });
        host.innerHTML = await res.text();

        // active link
        const cur = (location.pathname.split("/").pop() || "index.html").toLowerCase();
        host.querySelectorAll(".nav-link").forEach(a => {
          const m = (a.dataset.match || "").toLowerCase();
          if(m === cur) a.classList.add("active");
        });

        // mobile toggle
        const nav = host.querySelector(".site-nav");
        const toggle = host.querySelector(".nav-toggle");
        if(toggle && nav){
          toggle.addEventListener("click", () => {
            const isOpen = nav.classList.toggle("open");
            toggle.setAttribute("aria-expanded", String(isOpen));
          });
        }
      }catch(e){
        // n·∫øu kh√¥ng c√≥ nav.html th√¨ b·ªè qua
      }
    }
    mountNav();

    // ===== CT01 APP =====
    const $ = (id) => document.getElementById(id);

    const state = {
      agency: "",
      fullName: "",
      dob: "",
      gender: "",
      idNumber: "",
      phone: "",
      email: "",
      householdHeadName: "",
      relationToHead: "",
      headIdNumber: "",
      requestType: "tamtru",

      tempAddress: "",
      fromDate: "",
      toDate: "",
      reason: "",

      requestContent: "",
      members: [],
      declareDate: "",
      place: "",

      sigHead: "",
      sigOwner: "",
      sigGuardian: "",
      sigDeclarer: "",
      extraNote: ""
    };

    function sanitize(s){ return (s ?? "").toString().replace(/[<>]/g, ""); }
    function digitsOnly(s){ return (s ?? "").toString().replace(/\D/g, "").slice(0, 12); }

function lineFill(value, minWidthMm = 90){
  const v = sanitize(value).trim();
  const style = (minWidthMm && Number(minWidthMm) > 0) ? `style="min-width:${minWidthMm}mm"` : "";
  return `
    <span class="line ${v ? "filled" : ""}" ${style}>
      ${v ? `<span class="fill">${v}</span>` : "&nbsp;"}
    </span>
  `;
}


    function fmtLine(label, value, minWidthMm=90){
      return `<span class="nowrap">${label}</span> ${lineFill(value, minWidthMm)}`;
    }

    function renderBoxes(idStr){
      const d = digitsOnly(idStr);
      const arr = d.split("");
      let html = `<span class="boxes">`;
    for(let i=0;i<1;i++){
        html += `<span class="box box1">${arr[i] ? sanitize(arr[i]) : ""}</span>`;
      }
      for(let i=1;i<12;i++){
        html += `<span class="box">${arr[i] ? sanitize(arr[i]) : ""}</span>`;
      }
      html += `</span>`;
      return html;
    }

   function buildSuggestedContent() {
  const type = state.requestType;
  if (type === "khac") return;

  if (type === "tamtru") {
    const headName2 = sanitize(state.householdHeadName).trim();
    const addr = sanitize(state.tempAddress).trim();

    // ‚úÖ lu√¥n c√≥ bi·∫øn ƒë·ªÉ d√πng ph√≠a d∆∞·ªõi
    let addrFull = "";
    if (addr) {
      addrFull = headName2
        ? `Nh√† tr·ªç ${headName2} ${addr}`
        : ` ${addr}`;
    }

    const from = sanitize(state.fromDate).trim();
    const to = sanitize(state.toDate).trim();
    const reason = sanitize(state.reason).trim();

    let s = "ƒê·ªÅ ngh·ªã ƒëƒÉng k√Ω t·∫°m tr√∫";
    if (addrFull) s += ` t·∫°i: ${addrFull}.`;
    if (from) s += ` Th·ªùi gian t·∫°m tr√∫: t·ª´ ng√†y ${from}`;
    if (to) s += ` ƒë·∫øn ng√†y ${to}.`;
    else if (from) s += ".";
    if (reason) s += ` L√Ω do: ${reason}.`;

    return s;
  }

  if (type === "dieuchinh") {
    return "ƒê·ªÅ ngh·ªã ƒëi·ªÅu ch·ªânh/c·∫≠p nh·∫≠t th√¥ng tin c∆∞ tr√∫ trong C∆° s·ªü d·ªØ li·ªáu v·ªÅ c∆∞ tr√∫ (n√™u r√µ n·ªôi dung c·∫ßn ƒëi·ªÅu ch·ªânh).";
  }

  if (type === "xacnhan") {
    return "ƒê·ªÅ ngh·ªã x√°c nh·∫≠n th√¥ng tin v·ªÅ c∆∞ tr√∫ (n√™u r√µ n·ªôi dung c·∫ßn x√°c nh·∫≠n).";
  }
}

    function syncFromInputs(){
      state.agency = $("agency").value;

      state.fullName = $("fullName").value;
      state.dob = $("dob").value;
      state.gender = $("gender").value;

      state.idNumber = digitsOnly($("idNumber").value);
      $("idNumber").value = state.idNumber;

      state.phone = $("phone").value;
      state.email = $("email").value;

      state.householdHeadName = $("householdHeadName").value;
      state.relationToHead = $("relationToHead").value;

      state.headIdNumber = digitsOnly($("headIdNumber").value);
      $("headIdNumber").value = state.headIdNumber;

      state.requestType = $("requestType").value;

      state.tempAddress = $("tempAddress").value;
      state.fromDate = $("fromDate").value;
      state.toDate = $("toDate").value;
      state.reason = $("reason").value;

      const suggested = buildSuggestedContent();
      if(state.requestType !== "khac"){
        if(!$("requestContent").dataset.manual || $("requestContent").value.trim() === "" ){
          $("requestContent").value = suggested || $("requestContent").value;
          $("requestContent").dataset.manual = "";
        }
      }
      state.requestContent = $("requestContent").value;

      state.declareDate = $("declareDate").value;
      state.place = $("place").value;

      state.sigHead = $("sigHead").value;
      state.sigOwner = $("sigOwner").value;
      state.sigGuardian = $("sigGuardian").value;
      state.sigDeclarer = $("sigDeclarer").value;
      state.extraNote = $("extraNote").value;

      const rows = [...document.querySelectorAll("#membersTable tbody tr")];
      state.members = rows.map((tr) => {
        const get = (sel) => tr.querySelector(sel).value;
        return {
          name: get(".m-name"),
          dob: get(".m-dob"),
          gender: get(".m-gender"),
          id: digitsOnly(get(".m-id")),
          relation: get(".m-rel")
        };
      });
      rows.forEach((tr, idx) => tr.querySelector(".m-id").value = state.members[idx].id);
    }

    function renderMembersPrint(){
      if(!state.members.length){
        const blanks = Array.from({length:6}, ()=>({}));
        return blanks.map((m, i) => `
          <tr>
            <td style="text-align:center; width:10mm">${i+1}</td>
            <td style="width:60mm"></td>
            <td style="width:30mm"></td>
            <td style="width:20mm"></td>
            <td style="width:45mm"></td>
            <td></td>
          </tr>
        `).join("");
      }

      const maxRows = 8;
      const rows = state.members.slice(0, maxRows);

      const htmlRows = rows.map((m, i) => `
        <tr>
          <td style="text-align:center">${i+1}</td>
          <td>${sanitize(m.name||"")}</td>
          <td style="text-align:center">${sanitize(m.dob||"")}</td>
          <td style="text-align:center">${sanitize(m.gender||"")}</td>
          <td style="text-align:center">${sanitize(m.id||"")}</td>
          <td>${sanitize(m.relation||"")}</td>
        </tr>
      `).join("");

      const blanksCount = Math.max(0, maxRows - rows.length);
      const blankRows = Array.from({length:blanksCount}, (_,k)=> `
        <tr>
          <td style="text-align:center">${rows.length + k + 1}</td>
          <td></td><td></td><td></td><td></td><td></td>
        </tr>
      `).join("");

      return htmlRows + blankRows;
    }

function buildCT01Html(){
  const agency = sanitize(state.agency).trim();
  const fullName = sanitize(state.fullName).trim();
  const dob = sanitize(state.dob).trim();
  const gender = sanitize(state.gender).trim();
  const phone = sanitize(state.phone).trim();
  const email = sanitize(state.email).trim();
  const headName = sanitize(state.householdHeadName).trim();
  const rel = sanitize(state.relationToHead).trim();
  const content = sanitize(state.requestContent).trim();
  const place = sanitize(state.place).trim();
  const date = sanitize(state.declareDate).trim();
  const sigHead = sanitize(state.sigHead).trim();
  const sigOwner = sanitize(state.sigOwner).trim();
  const sigGuardian = sanitize(state.sigGuardian).trim();
  const sigDeclarer = sanitize(state.sigDeclarer).trim();

  return `
    <div class="center">
      <div style="font-size:14pt; font-weight:700">C·ªòNG H√íA X√É H·ªòI CH·ª¶ NGHƒ®A VI·ªÜT NAM</div>
      <div style="margin-top:2mm;font-size:14pt; font-weight:700">ƒê·ªôc l·∫≠p ‚Äì T·ª± do ‚Äì H·∫°nh ph√∫c
        <hr style="width: 180px; line:2px;">
        </div>
      <div style="margin-top:2mm; font-weight:700; font-size:13pt">T·ªú KHAI THAY ƒê·ªîI TH√îNG TIN C∆Ø TR√ö</div>
    </div>

    <div style="margin-top:5mm; font-size:13pt">
      <!-- K√≠nh g·ª≠i -->
      <div class="printLine" style="justify-content:center;">
        <span class="lbl">K√≠nh g·ª≠i (1):</span>
        ${lineFill(agency, 0)}
      </div>

      <!-- 1 -->
      <div class="printLine">
        <span class="lbl">1. H·ªç, ch·ªØ ƒë·ªám v√† t√™n khai sinh:</span>
        ${lineFill(fullName, 0)}
      </div>

      <!-- 2 + 3 -->
      <div class="printGrid2">
        <div class="printLine" style="margin-top:0">
          <span class="lbl">2. Ng√†y, th√°ng, nƒÉm sinh:</span>
          ${lineFill(dob, 0)}
        </div>
        <div class="printLine" style="margin-top:0">
          <span class="lbl">3. Gi·ªõi t√≠nh:</span>
          ${lineFill(gender, 0)}
        </div>
      </div>

      <!-- 4 -->
      <div class="printLine cccd">
        <span class="lbl">4. S·ªë ƒë·ªãnh danh c√° nh√¢n:</span>
        <span>${renderBoxes(state.idNumber)}</span>
      </div>

      <!-- 5 + 6 -->
      <div class="printGrid2">
        <div class="printLine" style="margin-top:0">
          <span class="lbl">5. S·ªë ƒëi·ªán tho·∫°i li√™n h·ªá:</span>
          ${lineFill(phone, 0)}
        </div>
        <div class="printLine" style="margin-top:0">
          <span class="lbl">6. Email:</span>
          ${lineFill(email, 0)}
        </div>
      </div>

      <!-- 7 + 8 -->
      <div class="printGrid2">
        <div class="printLine" style="margin-top:0">
          <span class="lbl">7. H·ªç, ch·ªØ ƒë·ªám v√† t√™n ch·ªß h·ªô:</span>
          ${lineFill(headName, 0)}
        </div>
        <div class="printLine" style="margin-top:0">
          <span class="lbl">8. M·ªëi quan h·ªá v·ªõi ch·ªß h·ªô:</span>
          ${lineFill(rel, 0)}
        </div>
      </div>

      <!-- 9 -->
      <div class="printLine cccd">
        <span class="lbl">9. S·ªë ƒë·ªãnh danh c√° nh√¢n c·ªßa ch·ªß h·ªô:</span>
        <span>${renderBoxes(state.headIdNumber)}</span>
      </div>

      <!-- 10 (d√†i) -->
<div class="printLine printLineLong">
  <span class="lbl">10. N·ªôi dung ƒë·ªÅ ngh·ªã (2):</span>
  <span class="val">${lineFill(content, 0)}</span>
</div>


      <!-- 11 -->
      <div style="margin-top:3mm">
        11. Nh·ªØng th√†nh vi√™n trong h·ªô gia ƒë√¨nh c√πng thay ƒë·ªïi:
      </div>

      <table class="printTable">
        <thead>
          <tr>
            <th style="width:10mm">TT</th>
            <th style="width:50mm">H·ªç, ch·ªØ ƒë·ªám v√† t√™n</th>
            <th style="width:20mm">Ng√†y, th√°ng, nƒÉm sinh</th>
            <th style="width:20mm">Gi·ªõi t√≠nh</th>
            <th style="width:45mm">S·ªë ƒë·ªãnh danh c√° nh√¢n</th>
            <th style="width:35mm">M·ªëi quan h·ªá v·ªõi ch·ªß h·ªô</th>
          </tr>
        </thead>
        <tbody>
          ${renderMembersPrint()}
        </tbody>
      </table>

      <!-- ƒê·ªãa danh + ng√†y th√°ng nƒÉm -->
      

      <!-- Ch·ªØ k√Ω -->
      <div class="sigRow">
        <div class="sig">
            .....,ng√†y.......th√°ng....nƒÉm.......
          <div class="cap">√ù KI·∫æN C·ª¶A CH·ª¶ H·ªò (3)</div>
          <div class="note">(K√Ω, ghi r√µ h·ªç t√™n)</div>
          <div class="fillName">${sigHead || ""}</div>
        </div>
        <div class="sig">
            .....,ng√†y.......th√°ng....nƒÉm.......
          <div class="cap">√ù KI·∫æN C·ª¶A CH·ª¶ S·ªû H·ªÆU<br/>CH·ªñ ·ªû H·ª¢P PH√ÅP (4)</div>
          <div class="note">(K√Ω, ghi r√µ h·ªç t√™n)</div>
          <div class="fillName">${sigOwner || ""}</div>
        </div>
        <div class="sig">
            .....,ng√†y.......th√°ng....nƒÉm.......
          <div class="cap">√ù KI·∫æN C·ª¶A CHA, M·∫∏<br/>NG∆Ø·ªúI GI√ÅM H·ªò (5)</div>
          <div class="note">(K√Ω, ghi r√µ h·ªç t√™n)</div>
          <div class="fillName">${sigGuardian || ""}</div>
        </div>
        <div class="sig">
            .....,ng√†y.......th√°ng....nƒÉm.......
          <div class="cap">NG∆Ø·ªúI K√ä KHAI (6)</div>
          <div class="note">(K√Ω, ghi r√µ h·ªç t√™n)</div>
          <div class="fillName">${sigDeclarer || ""}</div>
        </div>
      </div>
    </div>

    Ch√∫ th√≠ch:

(1) C∆° quan ƒëƒÉng k√Ω c∆∞ tr√∫.

(2) Ghi r√µ r√†ng, c·ª• th·ªÉ n·ªôi dung ƒë·ªÅ ngh·ªã. V√≠ d·ª•: ƒëƒÉng k√Ω th∆∞·ªùng tr√∫; ƒëƒÉng k√Ω t·∫°m tr√∫; t√°ch h·ªô; x√°c nh·∫≠n th√¥ng tin v·ªÅ c∆∞ tr√∫...

(3) √Åp d·ª•ng ƒë·ªëi v·ªõi c√°c tr∆∞·ªùng h·ª£p quy ƒë·ªãnh t·∫°i kho·∫£n 2, kho·∫£n 3, kho·∫£n 5, kho·∫£n 6 ƒêi·ªÅu 20; kho·∫£n 1 ƒêi·ªÅu 25; ƒëi·ªÉm a kho·∫£n 1 ƒêi·ªÅu 26 Lu·∫≠t C∆∞ tr√∫. Vi·ªác l·∫•y √Ω ki·∫øn c·ªßa ch·ªß h·ªô ƒë∆∞·ª£c th·ª±c hi·ªán theo c√°c ph∆∞∆°ng th·ª©c sau:

a) Ch·ªß h·ªô ghi r√µ n·ªôi dung ƒë·ªìng √Ω v√† k√Ω, ghi r√µ h·ªç t√™n v√†o T·ªù khai.

b) Ch·ªß h·ªô x√°c nh·∫≠n n·ªôi dung ƒë·ªìng √Ω th√¥ng qua ·ª©ng d·ª•ng VNeID ho·∫∑c c√°c d·ªãch v·ª• c√¥ng tr·ª±c tuy·∫øn kh√°c.

c) Ch·ªß h·ªô c√≥ vƒÉn b·∫£n ri√™ng ghi r√µ n·ªôi dung ƒë·ªìng √Ω (vƒÉn b·∫£n n√†y kh√¥ng ph·∫£i c√¥ng ch·ª©ng, ch·ª©ng th·ª±c).

 (4) √Åp d·ª•ng ƒë·ªëi v·ªõi c√°c tr∆∞·ªùng h·ª£p quy ƒë·ªãnh t·∫°i kho·∫£n 2, kho·∫£n 3, kho·∫£n 4, kho·∫£n 5, kho·∫£n 6 ƒêi·ªÅu 20; kho·∫£n 1 ƒêi·ªÅu 25 Lu·∫≠t C∆∞ tr√∫; ƒëi·ªÉm a kho·∫£n 1 ƒêi·ªÅu 26 Lu·∫≠t C∆∞ tr√∫. Vi·ªác l·∫•y √Ω ki·∫øn c·ªßa ch·ªß s·ªü h·ªØu ch·ªó ·ªü h·ª£p ph√°p ƒë∆∞·ª£c th·ª±c hi·ªán theo c√°c ph∆∞∆°ng th·ª©c sau:

a) Ch·ªß s·ªü h·ªØu ch·ªó ·ªü h·ª£p ph√°p ghi r√µ n·ªôi dung ƒë·ªìng √Ω v√† k√Ω, ghi r√µ h·ªç t√™n v√†o T·ªù khai.

b) Ch·ªß s·ªü h·ªØu ch·ªó ·ªü h·ª£p ph√°p x√°c nh·∫≠n n·ªôi dung ƒë·ªìng √Ω th√¥ng qua ·ª©ng d·ª•ng VNeID ho·∫∑c c√°c d·ªãch v·ª• c√¥ng tr·ª±c tuy·∫øn kh√°c.

c) Ch·ªß s·ªü h·ªØu ch·ªó ·ªü h·ª£p ph√°p c√≥ vƒÉn b·∫£n ri√™ng ghi r√µ n·ªôi dung ƒë·ªìng √Ω (vƒÉn b·∫£n n√†y kh√¥ng ph·∫£i c√¥ng ch·ª©ng, ch·ª©ng th·ª±c).

Ghi ch√∫: Tr∆∞·ªùng h·ª£p ch·ªß s·ªü h·ªØu h·ª£p ch·ªó ·ªü h·ª£p ph√°p g·ªìm nhi·ªÅu c√° nh√¢n, t·ªï ch·ª©c th√¨ ph·∫£i c√≥ √Ω ki·∫øn ƒë·ªìng √Ω c·ªßa t·∫•t c·∫£ c√°c ƒë·ªìng s·ªü h·ªØu tr·ª´ tr∆∞·ªùng h·ª£p ƒë√£ c√≥ th·ªèa thu·∫≠n v·ªÅ vi·ªác c·ª≠ ƒë·∫°i di·ªán c√≥ √Ω ki·∫øn ƒë·ªìng √Ω; Tr∆∞·ªùng h·ª£p ch·ªß s·ªü h·ªØu ch·ªó ·ªü h·ª£p ph√°p x√°c nh·∫≠n n·ªôi dung ƒë·ªìng √Ω th√¥ng qua ·ª©ng d·ª•ng VNeID th√¨ c√¥ng d√¢n ph·∫£i k√™ khai th√¥ng tin v·ªÅ h·ªç, ch·ªØ ƒë·ªám, t√™n v√† s·ªë ƒêDCN c·ªßa ch·ªß s·ªü h·ªØu ch·ªó ·ªü h·ª£p ph√°p.

(5) √Åp d·ª•ng ƒë·ªëi v·ªõi tr∆∞·ªùng h·ª£p ng∆∞·ªùi ch∆∞a th√†nh ni√™n, ng∆∞·ªùi h·∫°n ch·∫ø h√†nh vi d√¢n s·ª±, ng∆∞·ªùi kh√¥ng ƒë·ªß nƒÉng l·ª±c h√†nh vi d√¢n s·ª± c√≥ thay ƒë·ªïi th√¥ng tin v·ªÅ c∆∞ tr√∫. Vi·ªác l·∫•y √Ω ki·∫øn c·ªßa cha, m·∫π ho·∫∑c ng∆∞·ªùi gi√°m h·ªô ƒë∆∞·ª£c th·ª±c hi·ªán theo c√°c ph∆∞∆°ng th·ª©c sau:

a) Cha, m·∫π ho·∫∑c ng∆∞·ªùi gi√°m h·ªô ghi r√µ n·ªôi dung ƒë·ªìng √Ω v√† k√Ω, ghi r√µ h·ªç t√™n v√†o T·ªù khai.

b) Cha, m·∫π ho·∫∑c ng∆∞·ªùi gi√°m h·ªô x√°c nh·∫≠n n·ªôi dung ƒë·ªìng √Ω th√¥ng qua ·ª©ng d·ª•ng VNeID ho·∫∑c c√°c d·ªãch v·ª• c√¥ng tr·ª±c tuy·∫øn kh√°c.

c) Cha, m·∫π ho·∫∑c ng∆∞·ªùi gi√°m h·ªô c√≥ vƒÉn b·∫£n ri√™ng ghi r√µ n·ªôi dung ƒë·ªìng √Ω (vƒÉn b·∫£n n√†y kh√¥ng ph·∫£i c√¥ng ch·ª©ng, ch·ª©ng th·ª±c).

(6) Tr∆∞·ªùng h·ª£p n·ªôp tr·ª±c ti·∫øp ng∆∞·ªùi k√™ khai k√Ω, ghi r√µ h·ªç, ch·ªØ ƒë·ªám v√† t√™n v√†o T·ªù khai. Tr∆∞·ªùng h·ª£p n·ªôp qua c·ªïng d·ªãch v·ª• c√¥ng ho·∫∑c ·ª©ng d·ª•ng VNeID th√¨ ng∆∞·ªùi k√™ khai kh√¥ng ph·∫£i k√Ω v√†o m·ª•c n√†y.

(7) Ch·ªâ k√™ khai th√¥ng tin khi c√¥ng d√¢n ƒë·ªÅ ngh·ªã x√°c nh·∫≠n n·ªôi dung ƒë·ªìng √Ω th√¥ng qua ·ª©ng d·ª•ng VNeID.
  `;
}

// ‚úÖ nh·∫≠n d·ªØ li·ªáu t·ª´ trang qu√©t QR
(function hydrateFromPrefill(){
  const key = "ct01_prefill_v1";
  const raw = sessionStorage.getItem(key);
  if (!raw) return;
  try{
    const obj = JSON.parse(raw);
    Object.assign(state, obj || {});
    sessionStorage.removeItem(key);
    applyStateToInputs();
  }catch(e){}
})();

    function renderPreview(){
      syncFromInputs();
      const html = buildCT01Html();
      $("a4").innerHTML = html;
      $("a4Print").innerHTML = html;
    }

    function addMemberRow(data={}){
      const tbody = document.querySelector("#membersTable tbody");
      const idx = tbody.querySelectorAll("tr").length + 1;

      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td style="text-align:center; font-weight:800">${idx}</td>
        <td><input class="m-name" placeholder="H·ªç t√™n" value="${sanitize(data.name||"")}" /></td>
        <td><input class="m-dob" placeholder="dd/mm/yyyy" value="${sanitize(data.dob||"")}" /></td>
        <td><input class="m-gender" placeholder="Nam/N·ªØ" value="${sanitize(data.gender||"")}" /></td>
        <td><input class="m-id" maxlength="12" inputmode="numeric" placeholder="12 s·ªë" value="${sanitize(data.id||"")}" /></td>
        <td><input class="m-rel" placeholder="Quan h·ªá v·ªõi ch·ªß h·ªô" value="${sanitize(data.relation||"")}" /></td>
        <td style="text-align:center">
          <button class="btn danger" type="button" style="padding:8px 10px; border-radius:10px">‚úñ</button>
        </td>
      `;
      tr.querySelector("button").addEventListener("click", () => {
        tr.remove();
        reindexMembers();
        renderPreview();
      });

      tr.querySelectorAll("input").forEach(inp => {
        inp.addEventListener("input", () => {
          if(inp.classList.contains("m-id")) inp.value = digitsOnly(inp.value);
        });
        inp.addEventListener("change", renderPreview);
      });

      tbody.appendChild(tr);
    }

    function reindexMembers(){
      const rows = [...document.querySelectorAll("#membersTable tbody tr")];
      rows.forEach((tr, i) => tr.children[0].textContent = (i+1));
    }

    function downloadJson(){
      syncFromInputs();
      const blob = new Blob([JSON.stringify(state, null, 2)], {type:"application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "ct01_data.json";
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    function loadJsonFile(file){
      const reader = new FileReader();
      reader.onload = () => {
        try{
          const obj = JSON.parse(reader.result);
          Object.assign(state, obj || {});
          applyStateToInputs();
          renderPreview();
        }catch(e){
          alert("File JSON kh√¥ng h·ª£p l·ªá.");
        }
      };
      reader.readAsText(file);
    }

    function applyStateToInputs(){
      $("agency").value = state.agency || "";
      $("fullName").value = state.fullName || "";
      $("dob").value = state.dob || "";
      $("gender").value = state.gender || "";
      $("idNumber").value = state.idNumber || "";
      $("phone").value = state.phone || "";
      $("email").value = state.email || "";

      $("householdHeadName").value = state.householdHeadName || "";
      $("relationToHead").value = state.relationToHead || "";
      $("headIdNumber").value = state.headIdNumber || "";
      $("requestType").value = state.requestType || "tamtru";

      $("tempAddress").value = state.tempAddress || "";
      $("fromDate").value = state.fromDate || "";
      $("toDate").value = state.toDate || "";
      $("reason").value = state.reason || "";

      $("requestContent").value = state.requestContent || "";
      $("requestContent").dataset.manual = "1";

      $("declareDate").value = state.declareDate || "";
      $("place").value = state.place || "";

      $("sigHead").value = state.sigHead || "";
      $("sigOwner").value = state.sigOwner || "";
      $("sigGuardian").value = state.sigGuardian || "";
      $("sigDeclarer").value = state.sigDeclarer || "";
      $("extraNote").value = state.extraNote || "";

      const tbody = document.querySelector("#membersTable tbody");
      tbody.innerHTML = "";
      (state.members || []).forEach(m => addMemberRow(m));
    }

    function resetAll(){
      document.querySelectorAll("input, textarea, select").forEach(el => {
        if(el.id === "requestType") el.value = "tamtru";
        else el.value = "";
      });
      $("requestContent").dataset.manual = "";
      document.querySelector("#membersTable tbody").innerHTML = "";
      renderPreview();
    }

    $("requestContent").addEventListener("input", () => $("requestContent").dataset.manual = "1");
    document.querySelectorAll("input, select, textarea").forEach(el => el.addEventListener("change", renderPreview));

    $("btnAddMember").addEventListener("click", () => { addMemberRow({}); renderPreview(); });
    $("btnPreview").addEventListener("click", renderPreview);
    $("btnPrint").addEventListener("click", () => { renderPreview(); window.print(); });
    $("btnDownloadJson").addEventListener("click", downloadJson);

    $("btnLoadJson").addEventListener("click", () => $("jsonFile").click());
    $("jsonFile").addEventListener("change", (e) => {
      const f = e.target.files?.[0];
      if(f) loadJsonFile(f);
      e.target.value = "";
    });

    $("btnReset").addEventListener("click", () => {
      if(confirm("X√≥a to√†n b·ªô d·ªØ li·ªáu ƒëang nh·∫≠p?")) resetAll();
    });

    // init defaults
    const today = new Date();
    const dd = String(today.getDate()).padStart(2,"0");
    const mm = String(today.getMonth()+1).padStart(2,"0");
    const yyyy = today.getFullYear();
    $("declareDate").value = `${dd}/${mm}/${yyyy}`;
    $("place").value = "TP. H·ªì Ch√≠ Minh";

    renderPreview();
  </script>

  <!-- ‚úÖ N·∫øu b·∫°n c√≥ script.js ri√™ng kh√°c, h√£y ƒë·ªÉ n√≥ ·ªü ƒë√¢y (1 l·∫ßn th√¥i) -->
  <!-- <script src="./script.js"></script> -->
</body>
</html>
